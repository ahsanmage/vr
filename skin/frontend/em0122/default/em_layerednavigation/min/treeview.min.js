var EM_TreeView=Class.create();EM_TreeView.prototype={initialize:function(e){this.element=null,this.childs=[],this.parent=null,this.attach(e)},attach:function(e){this.element=$(e);var t=this;this.element.down("ol")&&(this.element.down("ol").childElements().each(function(e){var n=new EM_TreeItem;t.childs.push(n),n.parent=t,n.attach(e)}),this._decorate())},collapseAll:function(){EM_TreeView.recursiveCollapse(this)},expandAll:function(){EM_TreeView.recursiveExpand(this)},getSelect:function(){return this.curSel},select:function(){this.childs.length>0&&this.childs[0].select()},_decorate:function(){var e=this.element.down("ol").childElements();e.each(function(e){e.removeClassName("first last")}),e[e.length-1].addClassName("last"),e.length>1&&e[0].addClassName("first")}},EM_TreeView.recursiveExpand=function(e){e.childs.each(function(e){e.expand(),EM_TreeView.recursiveExpand(e)})},EM_TreeView.recursiveCollapse=function(e){e.childs.each(function(e){e.collapse(),EM_TreeView.recursiveCollapse(e)})};var EM_TreeItem=Class.create();EM_TreeItem.prototype={initialize:function(){this.childs=[],this.element=null,this.parent=null},attach:function(e){this.element=e;var t=this;this.element.down("ol")&&(this.element.down("ol").childElements().each(function(e){var n=new EM_TreeItem;t.childs.push(n),n.parent=t,n.attach(e)}),this._decorate())},collapse:function(){this.hasChild()&&(this.element.removeClassName("expanded").addClassName("collapsed"),this.element.down("ol").hide())},expand:function(){this.hasChild()&&(this.element.removeClassName("collapsed").addClassName("expanded"),this.element.down("ol").show())},toggle:function(){this._isExpand()?this.collapse():this.expand()},hasChild:function(){return this.childs.length>0},select:function(){this.element.children(".label").click()},_decorate:function(){if(this.hasChild()){this.element.down(">.icon")||this.element.insert({top:EM_TreeItem.createIconElement(this)});var e=this.element.down("ol").childElements();e.each(function(e){e.removeClassName("first last")}),e[e.length-1].addClassName("last"),e.length>1&&e[0].addClassName("first")}},_isExpand:function(){return this.element.down("ol").visible()}},EM_TreeItem.createIconElement=function(e){var t=document.createElement("div");return t.className="icon",t.innerHTML=" ",t.onclick=function(){e.toggle()},t};